
const anketler = {
  cevrecimisiniz: {
    baslik: "Ne kadar Ã§evrecisiniz?",
    sorular: [
      "Geri dÃ¶nÃ¼ÅŸÃ¼m kutularÄ±nÄ± dÃ¼zenli kullanÄ±r mÄ±sÄ±nÄ±z?",
      "Plastik poÅŸet yerine bez Ã§anta kullanÄ±r mÄ±sÄ±nÄ±z?",
      "KullanmadÄ±ÄŸÄ±nÄ±z elektronik cihazlarÄ± fiÅŸten Ã§eker misiniz?",
      "Suyu gereksiz yere aÃ§Ä±k bÄ±rakmaz mÄ±sÄ±nÄ±z?",
      "Toplu taÅŸÄ±ma araÃ§larÄ±nÄ± tercih eder misiniz?",
      "KaÄŸÄ±t israfÄ±nÄ± Ã¶nlemeye dikkat eder misiniz?",
      "Evde enerji tasarrufu yapar mÄ±sÄ±nÄ±z?",
      "DoÄŸaya Ã§Ã¶p atmaz mÄ±sÄ±nÄ±z?",
      "Ã‡evreyle ilgili kampanyalara katÄ±lÄ±r mÄ±sÄ±nÄ±z?",
      "AÄŸaÃ§ dikme etkinliklerine katÄ±lÄ±r mÄ±sÄ±nÄ±z?"
    ]
  },
  hayvansever: {
    baslik: "Patili dostlara bakÄ±ÅŸÄ±mÄ±z",
    sorular: [
      "Evcil hayvan sahiplenmeyi dÃ¼ÅŸÃ¼nÃ¼yor musunuz?",
      "Sokak hayvanlarÄ±na mama ve su verir misiniz?",
      "Hayvan barÄ±naklarÄ±na destek olmayÄ± dÃ¼ÅŸÃ¼nÃ¼yor musunuz?",
      "HayvanlarÄ±n haklarÄ±na saygÄ± gÃ¶sterir misiniz?",
      "Kedi ve kÃ¶peklerin bakÄ±mÄ±nÄ± dÃ¼zenli yapar mÄ±sÄ±nÄ±z?",
      "Hayvanlara zarar verecek davranÄ±ÅŸlardan kaÃ§Ä±nÄ±r mÄ±sÄ±nÄ±z?",
      "Hayvanlarla ilgili eÄŸitim ve kampanyalarÄ± takip eder misiniz?",
      "Evcil hayvanÄ±nÄ±zÄ± aÅŸÄ± ve saÄŸlÄ±k kontrollerine gÃ¶tÃ¼rÃ¼r mÃ¼sÃ¼nÃ¼z?",
      "Hayvanlar iÃ§in gÃ¶nÃ¼llÃ¼ faaliyetlere katÄ±lÄ±r mÄ±sÄ±nÄ±z?",
      "Hayvanlara karÅŸÄ± duyarlÄ± bir Ã§evreyi destekler misiniz?"
    ]
  },
   topraginsesi: {
    baslik: "TopraÄŸÄ±n Sesi",
    sorular: [
      "MusluklarÄ± aÃ§Ä±k bÄ±rakmadan diÅŸlerinizi fÄ±rÃ§alar mÄ±sÄ±nÄ±z?",
      "DuÅŸ sÃ¼resini 5 dakikadan uzun tutar mÄ±sÄ±nÄ±z?",
      "BahÃ§e sulamasÄ±nÄ± sabah/akÅŸam yapar mÄ±sÄ±nÄ±z?",
      "Evde su tasarruflu musluk baÅŸlÄ±klarÄ± kullanÄ±r mÄ±sÄ±nÄ±z?",
      "BulaÅŸÄ±klarÄ± elde yÄ±kamak yerine bulaÅŸÄ±k makinesi kullanÄ±r mÄ±sÄ±nÄ±z?",
      "Ã‡amaÅŸÄ±rlarÄ± tam dolmadan Ã§alÄ±ÅŸtÄ±rÄ±r mÄ±sÄ±nÄ±z?",
      "YaÄŸmur suyunu bahÃ§e sulamada kullanÄ±r mÄ±sÄ±nÄ±z?",
      "Gereksiz su kullanÄ±mÄ±nÄ± azaltmak iÃ§in dikkat eder misiniz?",
      "Toprak ve bitkiler iÃ§in gereksiz su harcar mÄ±sÄ±nÄ±z?",
      "Su kaynaklarÄ±nÄ± korumak iÃ§in farkÄ±ndalÄ±k yaratÄ±r mÄ±sÄ±nÄ±z?"
    ]
  },
   minimalAtik: {
    baslik: "Minimal AtÄ±k, Maximum Etki",
    sorular: [
      "Evde geri dÃ¶nÃ¼ÅŸÃ¼m kutularÄ±nÄ± kullanÄ±yor musunuz?",
      "KaÄŸÄ±t, plastik ve camlarÄ± ayrÄ± topluyor musunuz?",
      "Tek kullanÄ±mlÄ±k Ã¼rÃ¼nlerden mÃ¼mkÃ¼n olduÄŸunca kaÃ§Ä±nÄ±yor musunuz?",
      "AlÄ±ÅŸveriÅŸlerde ambalajsÄ±z Ã¼rÃ¼nleri tercih ediyor musunuz?",
      "ArtÄ±klarÄ± kompost yapÄ±yor veya organik atÄ±klarÄ± deÄŸerlendiriyor musunuz?",
      "Gereksiz paketlemeyi azaltmak iÃ§in dikkat ediyor musunuz?",
      "SÄ±fÄ±r atÄ±k yaklaÅŸÄ±mÄ±na uyuyor musunuz?",
      "Plastik ÅŸiÅŸe yerine tekrar kullanÄ±labilir ÅŸiÅŸe kullanÄ±yor musunuz?",
      "KullanÄ±lmÄ±ÅŸ malzemeleri yeniden deÄŸerlendiriyor musunuz?",
      "Geri dÃ¶nÃ¼ÅŸÃ¼m ve sÄ±fÄ±r atÄ±k konularÄ±nda Ã§evrenize farkÄ±ndalÄ±k yaratÄ±yor musunuz?"
    ]
  },
  karbonAyakizi: {
    baslik: "Karbon Ayak Ä°zi",
    sorular: [
      "GÃ¼nlÃ¼k kÄ±sa mesafeleri araÃ§ yerine yÃ¼rÃ¼yerek gidiyor musunuz?",
      "Hafta iÃ§i iÅŸ veya okul iÃ§in toplu taÅŸÄ±ma kullanÄ±yor musunuz?",
      "Bisiklet kullanÄ±yor musunuz?",
      "Ã–zel araÃ§ kullanÄ±mÄ±nÄ±zÄ± azaltmak iÃ§in dikkat ediyor musunuz?",
      "UÃ§ak yolculuÄŸu yaparken alternatifleri deÄŸerlendiriyor musunuz?",
      "AraÃ§ kullanÄ±rken yakÄ±t tasarrufuna dikkat ediyor musunuz?",
      "AraÃ§ paylaÅŸÄ±mÄ± veya carpool yapÄ±yor musunuz?",
      "Elektrikli veya hibrit araÃ§ tercih ediyor musunuz?",
      "Hafta sonlarÄ± uzun mesafeler iÃ§in araÃ§ yerine otobÃ¼s veya tren kullanÄ±yor musunuz?",
      "Karbon salÄ±nÄ±mÄ±nÄ± azaltmak iÃ§in genel farkÄ±ndalÄ±ÄŸa sahip misiniz?"
    ]
  },
   iklimNabzi: {
    baslik: "Ä°klim NabzÄ±",
    sorular: [
      "Ä°klim deÄŸiÅŸikliÄŸi hakkÄ±nda bilgi sahibi misiniz?",
      "Ä°klim deÄŸiÅŸikliÄŸinin etkilerinden endiÅŸe duyuyor musunuz?",
      "KÃ¼resel Ä±sÄ±nma konusunda farkÄ±ndalÄ±ÄŸÄ±nÄ±zÄ± artÄ±rmak iÃ§in Ã§aba harcÄ±yor musunuz?",
      "Enerji ve kaynak kullanÄ±mÄ±nda Ã§evreyi dikkate alÄ±yor musunuz?",
      "Ä°klim deÄŸiÅŸikliÄŸiyle mÃ¼cadele eden kampanyalara katÄ±lÄ±yor musunuz?",
      "GÃ¼nlÃ¼k alÄ±ÅŸkanlÄ±klarÄ±nÄ±zÄ±n iklim Ã¼zerindeki etkilerini gÃ¶z Ã¶nÃ¼nde bulunduruyor musunuz?",
      "Ä°klim deÄŸiÅŸikliÄŸi hakkÄ±nda Ã§evrenizle konuÅŸuyor musunuz?",
      "Sera gazÄ± salÄ±nÄ±mÄ±nÄ± azaltacak davranÄ±ÅŸlar sergiliyor musunuz?",
      "Ä°klim deÄŸiÅŸikliÄŸi konusunda kaygÄ±nÄ±z sizi harekete geÃ§iriyor mu?",
      "KÃ¼resel iklim hedeflerine ulaÅŸmak iÃ§in bireysel olarak katkÄ± saÄŸlÄ±yor musunuz?"
    ]
  }
};


let aktifAnketAdi = null; // Aktif anket adÄ±nÄ± tutmak iÃ§in yeni deÄŸiÅŸken

function anketiBaslat(anketAdi) {
    document.getElementById("anketListesi").classList.add("hidden");
    document.getElementById("anketAlani").classList.remove("hidden");

    document.querySelector("#anaBaslik").classList.add("hidden"); // H1 baÅŸlÄ±ÄŸÄ±nÄ± gizle
    document.querySelector(".main-header").classList.add("hidden-on-poll");

    document.querySelector(".main-header").classList.add("hidden-on-poll");

    const anket = anketler[anketAdi];
    document.getElementById("anketBaslik").innerText = anket.baslik;

    const form = document.getElementById("anketFormu");
    form.innerHTML = "";
    
    // Aktif anket adÄ±nÄ± kaydet
    aktifAnketAdi = anketAdi; 

    // Ã‡ubuÄŸu sÄ±fÄ±rla ve gÃ¶nder butonunu pasif yap
    ilerlemeyiSifirla(); 

    anket.sorular.forEach((soru, i) => {
        const soruDiv = document.createElement("div");
        soruDiv.classList.add("soru");

        // Her sorunun kendi benzersiz adÄ± olmalÄ±: soruX
        const soruAdi = `soru${i}`; 

        soruDiv.innerHTML = `
            <p>${i + 1}. ${soru}</p>
            <label><input type="radio" name="${soruAdi}" value="5"> Evet</label>
            <label><input type="radio" name="${soruAdi}" value="3"> Bazen</label>
            <label><input type="radio" name="${soruAdi}" value="1"> HayÄ±r</label>
        `;

        form.appendChild(soruDiv);
    });

    // Anket alanÄ±ndaki tÃ¼m radyo butonlarÄ±nÄ± dinle
    const radioButtons = form.querySelectorAll('input[type="radio"]');
    radioButtons.forEach(radio => {
        radio.addEventListener('change', () => {
            // Bir seÃ§im yapÄ±ldÄ±ÄŸÄ±nda ilerlemeyi gÃ¼ncelle
            ilerlemeyiGuncelle(aktifAnketAdi);
        });
    });
}


function anketiGonder() {
  const sorular = document.querySelectorAll("#anketFormu .soru");
  let toplamPuan = 0;

  sorular.forEach((_, i) => {
    const secilen = document.querySelector(`input[name="soru${i}"]:checked`);
    if (secilen) toplamPuan += parseInt(secilen.value);
  });

  const ortalama = toplamPuan / sorular.length;
  let sonuc = "";

  // Puanlara gÃ¶re yorum
  const baslik = document.getElementById("anketBaslik").innerText;

  if (baslik === "TopraÄŸÄ±n Sesi") {
    if (ortalama >= 4.5) sonuc = "ğŸŒŠ Harika! Su tasarrufuna Ã§ok dikkat ediyorsunuz ve kuraklÄ±ÄŸa etkiniz dÃ¼ÅŸÃ¼k.";
    else if (ortalama >= 3) sonuc = "ğŸ’§ Fena deÄŸil! Su kullanÄ±mÄ±nda dikkatli olmalÄ±sÄ±nÄ±z.";
    else sonuc = "âš ï¸ Su kullanÄ±m alÄ±ÅŸkanlÄ±klarÄ±nÄ±z kuraklÄ±ÄŸa ciddi etkiler yaratÄ±yor. Daha bilinÃ§li olun!";
  } else if (baslik === "Ne kadar Ã§evrecisiniz?") {
    if (ortalama >= 4.5) sonuc = "ğŸŒ¿ Harika! GerÃ§ek bir Ã§evre dostusunuz!";
    else if (ortalama >= 3) sonuc = "ğŸŒ± Fena deÄŸil! Ã‡evre bilinciniz yÃ¼ksek ama biraz daha dikkatli olabilirsiniz.";
    else sonuc = "âš ï¸ Ã‡evre konusunda daha bilinÃ§li olmalÄ±sÄ±nÄ±z.";
  } else if (baslik === "Patili dostlara bakÄ±ÅŸÄ±mÄ±z") {
    if (ortalama >= 4.5) sonuc = "ğŸ¾ Tebrikler! GerÃ§ek bir hayvanseversiniz!";
    else if (ortalama >= 3) sonuc = "ğŸ¶ Fena deÄŸil! Hayvan sevgisini biraz daha geliÅŸtirebilirsiniz.";
    else sonuc = "ğŸ± Hayvanlara karÅŸÄ± daha duyarlÄ± olmalÄ±sÄ±nÄ±z.";
  } else if (baslik === "Minimal AtÄ±k, Maximum Etki") {
    if (ortalama >= 4.5) sonuc = "â™»ï¸ Harika! Geri dÃ¶nÃ¼ÅŸÃ¼m ve sÄ±fÄ±r atÄ±k konusunda Ã§ok bilinÃ§lisiniz!";
    else if (ortalama >= 3) sonuc = "â™»ï¸ Fena deÄŸil! AlÄ±ÅŸkanlÄ±klarÄ±nÄ±zÄ± biraz daha geliÅŸtirebilirsiniz.";
    else sonuc = "âš ï¸ Geri dÃ¶nÃ¼ÅŸÃ¼m ve sÄ±fÄ±r atÄ±k alÄ±ÅŸkanlÄ±klarÄ±nÄ±z zayÄ±f. Daha bilinÃ§li olun!";
  } else if (baslik === "Karbon Ayak Ä°zi") {
    if (ortalama >= 4.5) sonuc = "ğŸŒ± Harika! Karbon ayak izinizi minimum seviyede tutuyorsunuz.";
    else if (ortalama >= 3) sonuc = "ğŸš¶â€â™‚ï¸ Fena deÄŸil! Karbon ayak izinizi biraz daha azaltabilirsiniz.";
    else sonuc = "âš ï¸ Karbon ayak izinizi ciddi ÅŸekilde azaltmalÄ±sÄ±nÄ±z. Daha Ã§evreci ulaÅŸÄ±m tercihleri yapÄ±n!";
  } else if (baslik === "Ä°klim NabzÄ±") {
    if (ortalama >= 4.5) sonuc = "ğŸŒ Harika! Ä°klim deÄŸiÅŸikliÄŸi konusunda Ã§ok bilinÃ§li ve kaygÄ±nÄ±zÄ± eyleme dÃ¶nÃ¼ÅŸtÃ¼rÃ¼yorsunuz.";
    else if (ortalama >= 3) sonuc = "ğŸŒ± Fena deÄŸil! Ä°klim farkÄ±ndalÄ±ÄŸÄ±nÄ±zÄ± artÄ±rabilirsiniz.";
    else sonuc = "âš ï¸ Ä°klim deÄŸiÅŸikliÄŸi hakkÄ±nda daha bilinÃ§li olmanÄ±z gerekiyor. KaygÄ±nÄ±zÄ± eyleme dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n!";
}
 document.getElementById("sonucMetni").innerText = sonuc;

//sonradan ekledim tekrar Ã§Ã¶z butonu iÃ§in
document.getElementById("tekrarBtn").classList.remove("hidden");
// YENÄ° DÃœZENLEME: Tekrar Ã‡Ã¶z butonunu aktif yap
    const tekrarBtn = document.getElementById('tekrarBtn');
    if (tekrarBtn) {
        tekrarBtn.disabled = false;           // Aktif yap
        tekrarBtn.style.opacity = 1;          // Aktif gÃ¶rÃ¼nÃ¼m ver
    }
// YENÄ° DÃœZENLEME BAÅLANGICI: GÃ–NDER BUTONU Ä°Ã‡Ä°N KESÄ°N PASÄ°FLEÅTÄ°RME
//anket bir kez Ã§Ã¶zÃ¼lÃ¼p gÃ¶nderildikten sonra gÃ¶nder pasifleÅŸir
    const gonderBtn = document.getElementById("gonderBtn");
    if (gonderBtn) {
        gonderBtn.disabled = true; // Pasif yap
        gonderBtn.style.opacity = 0.5; // SoluklaÅŸtÄ±r
    }

}


function anketleriGoster() {
    document.getElementById("anketListesi").classList.remove("hidden");
    document.getElementById("anketAlani").classList.add("hidden");
    document.getElementById("sonucMetni").innerText = "";

    document.querySelector("#anaBaslik").classList.remove("hidden"); // H1 baÅŸlÄ±ÄŸÄ±nÄ± gÃ¶ster
    document.querySelector(".main-header").classList.remove("hidden-on-poll");

    document.querySelector(".main-header").classList.remove("hidden-on-poll");
    
    // Geri dÃ¶nÃ¼lÃ¼rken Ã§ubuÄŸu sÄ±fÄ±rla
    ilerlemeyiSifirla(); 
    aktifAnketAdi = null; // Aktif anket bilgisini temizle
}

// =======================================================================
// PROGRESS BAR MANTIÄI VE FONKSÄ°YONLARI
// =======================================================================

/**
 * Mevcut anketin ilerlemesini hesaplar ve Ã§ubuÄŸu gÃ¼nceller.
 * Bu fonksiyon, her radio buton tÄ±klamasÄ±nda tetiklenecektir.
 * @param {string} anketAdi - Aktif anketin anahtarÄ± (Ã¶rn: 'cevrecimisiniz').
 */
function ilerlemeyiGuncelle(anketAdi) {
    const toplamSoruSayisi = anketler[anketAdi].sorular.length;
    
    // CevaplanmÄ±ÅŸ (seÃ§ilmiÅŸ) radyo butonlarÄ±nÄ±n sayÄ±sÄ±nÄ± bul
    const cevaplananSoruSayisi = document.querySelectorAll(`#anketFormu input[type="radio"]:checked`).length;

    // EÄŸer anketin tÃ¼m sorularÄ± cevaplanmÄ±ÅŸsa, sayaÃ§ toplam soru sayÄ±sÄ±na eÅŸit olmalÄ±.
    const gecerliCevapSayisi = Math.min(cevaplananSoruSayisi, toplamSoruSayisi);
    
    // YÃ¼zdeyi hesapla
    const yuzde = Math.round((gecerliCevapSayisi / toplamSoruSayisi) * 100);
    const gecerliYuzde = Math.min(100, yuzde);

    // HTML Ã–ÄŸelerini SeÃ§
    const progressBar = document.getElementById('anket-progress-bar');
    const progressText = document.getElementById('anket-progress-text');

    if (progressBar && progressText) {
        
        // Renk Hesaplama (KÄ±rmÄ±zÄ± -> Turuncu -> YeÅŸil)
        const red = Math.round(255 * (100 - gecerliYuzde) / 100); 
        const green = Math.round(255 * gecerliYuzde / 100); 
        const blue = 0; 
        const renkKodu = `rgb(${red}, ${green}, ${blue})`;

        // Ã‡ubuk GeniÅŸliÄŸini, Rengini ve Metni GÃ¼ncelle
        progressBar.style.width = gecerliYuzde + '%';
        progressBar.style.backgroundColor = renkKodu;
        progressText.textContent = gecerliYuzde + '% Ä°lerlendi';

        // Anket tamamlandÄ±ÄŸÄ±nda gÃ¶nder butonunu vurgula (isteÄŸe baÄŸlÄ±)
        const gonderBtn = document.getElementById('gonderBtn');
        if (gonderBtn) {
            gonderBtn.disabled = gecerliYuzde !== 100;
            gonderBtn.style.opacity = gecerliYuzde === 100 ? 1 : 0.5;
        }
    }
 }

/**
 * Anket baÅŸlatÄ±ldÄ±ÄŸÄ±nda veya geri dÃ¶nÃ¼ldÃ¼ÄŸÃ¼nde Ã§ubuÄŸu sÄ±fÄ±rlar.
 */
function ilerlemeyiSifirla() {
    const progressBar = document.getElementById('anket-progress-bar');
    const progressText = document.getElementById('anket-progress-text');
    const gonderBtn = document.getElementById('gonderBtn');

    if (progressBar && progressText) {
        progressBar.style.width = '0%';
        progressBar.style.backgroundColor = '#ff0000'; // BaÅŸlangÄ±Ã§ rengi
        progressText.textContent = '0% Ä°lerlendi';
    }
    if (gonderBtn) {
        gonderBtn.disabled = true;
        gonderBtn.style.opacity = 0.5;
    }
    // YENÄ° DÃœZENLEME: Tekrar Ã‡Ã¶z butonunu gÃ¶rÃ¼nÃ¼r (hidden'Ä± kaldÄ±r) ve pasif yap.
    if (tekrarBtn) {
        tekrarBtn.classList.remove("hidden"); // GÃ¶rÃ¼nÃ¼r yap
        tekrarBtn.disabled = true;           // Pasif yap
        tekrarBtn.style.opacity = 0.5;       // Pasif gÃ¶rÃ¼nÃ¼m ver (isteÄŸe baÄŸlÄ±)
    }
}

//tekrar Ã§Ã¶z butomu iÃ§in eklediÄŸim kod
function anketiTekrarCoz() {
  if (aktifAnketAdi) {
    // AynÄ± anketi baÅŸtan yÃ¼kle
    anketiBaslat(aktifAnketAdi);
    // SonuÃ§ metnini temizle
    document.getElementById("sonucMetni").innerText = "";
  }
}